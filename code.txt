 For i = 2 To Sheet.Range("D100000").End(xlUp).Row
If Sheet1.Cells(i, 1) = Me.ComboBox1 Then
myr = myr + 1
For Colum = 1 To 4
database(myr, Colum) = Sheet1.Cells(i, Colum)

Next Colum
End If
Next i
Me.ListBox1.List = database



Dim OutlookApp As Object
    Dim OutlookMail As Object
    Set OutlookApp = CreateObject("Outlook.Application")
    Set OutlookMail = OutlookApp.CreateItem(0)
    With OutlookMail
        .to = EnviarPara
        .CC = ""
        .BCC = ""
        .Subject = "Retorno sobre solicitação de crédito"
        .Body = Mensagem
        .Display '
    End With
    Set OutlookMail = Nothing
    Set OutlookApp = Nothing









Private Sub UserForm_Activate()
    
    With Me.ComboBox1
        .AddItem "All"
        .AddItem "Name"
        .AddItem "Mobile Number"
        .AddItem "WhatsApp Number"
        .AddItem "Email ID"
        .AddItem "Address"
        .AddItem "Comments"
        .Value = "All"
    End With
    
    Call Refresh_List_Box
End Sub










==


'delete
Private Sub CommandButton5_Click()

If Me.ListBox1.ListIndex >= 0 Then
    Dim sh As Worksheet
    Set sh = ThisWorkbook.Sheets("AddressBook")
    
    Dim myRow As Long
    myRow = Application.WorksheetFunction.Match(Me.ListBox1.List(Me.ListBox1.ListIndex, 0), sh.Range("A:A"), 0)
    
    sh.Range("A" & myRow).EntireRow.Delete
    
    Call Refresh_List_Box
    
    MsgBox "Record has been deleted", vbInformation
    
End If

End Sub


==




















 
Sub Refresh_List_Box()

Application.ScreenUpdating = False

Dim sh As Worksheet
Set sh = ThisWorkbook.Sheets("AddressBook")

Dim dsh As Worksheet
Set dsh = ThisWorkbook.Sheets("AddressBook_Display")


sh.AutoFilterMode = False
dsh.AutoFilterMode = False
dsh.UsedRange.ClearContents

''''' Copy data from Addressbook worksheet to Addressbook_Display worksheet
  
If Me.ComboBox1.Value <> "All" Then
    Dim my_Column As Integer
    my_Column = Application.WorksheetFunction.Match(Me.ComboBox1.Value, sh.Range("1:1"), 0)
    sh.UsedRange.AutoFilter my_Column, "*" & Me.TextBox7.Value & "*"
End If
  
sh.UsedRange.Copy dsh.Range("A1")
sh.AutoFilterMode = False

'''''''''' Display data in list box
Dim LR As Long
LR = Application.WorksheetFunction.CountA(dsh.Range("A:A"))

If LR = 1 Then LR = 2

With Me.ListBox1
    .ColumnCount = 7
    .ColumnHeads = True
    .ColumnWidths = "0,100,100,100,110,150,170"
    .RowSource = "AddressBook_Display!A2:G" & LR
End With

Me.lbl_Count.Caption = Application.WorksheetFunction.CountA(dsh.Range("A:A")) - 1 & " Address"


End Sub