Private Sub CommandButton1_Click()
 
nomecurso = Me.ComboBox1.Value


Application.ScreenUpdating = False



fName = "C:\Users\T780000\Desktop\MARÇO\AVANÇAR\Automação fluxo de certificacoes\" & nomecurso & ".xlsx"
'fName = "C:\Users\T731137\Desktop\Automação fluxo de certificacoes\" & nomecurso & ".xlsx"
           
         Workbooks.Open Filename:=fName, UpdateLinks:=True
         Workbooks(nomecurso & ".xlsx").Worksheets("historico de acessos").Activate
         Worksheets("historico de acessos").PivotTables("TDHIST").PivotCache.Refresh


     Range("a3").Activate
     Selection.End(xlDown).Select
     row_ult = ActiveCell.Row

    
     Range("a2").Activate
     Selection.End(xlToRight).Select
     ColLetter = Split(Cells(1, ActiveCell.Column).Address, "$")(1)
        
     ActiveCell.Offset(1, 0).Activate
     row3 = ActiveCell.Row
       
     ActiveCell.Offset(1, 0).Activate
     row4 = ActiveCell.Row
      
     
     Range(ColLetter & row_ult, ColLetter & row4).Select
     Selection.Clear
 
 
     Range(ColLetter & row_ult, ColLetter & row3).Select
     Selection.FillDown
     
                
                

             
   'processo aprovado
      Workbooks(nomecurso & ".xlsx").Worksheets("APROVADOS").Activate
      ActiveSheet.Range("$C$2:$D$9999").AutoFilter Field:=2
      Worksheets("APROVADOS").PivotTables("TDAPROV").PivotCache.Refresh

    
      Range("a3").Activate
      Selection.End(xlDown).Select
      row_ult_ap = ActiveCell.Row
       
       
      Range("c4:d9999").Select
      Selection.Clear
      
      
      Range("c" & row_ult_ap, "d" & row3).Select
      Selection.FillDown
      Range("a2").Activate
            
            
      ActiveSheet.Range("$C$2:$D$9999").AutoFilter Field:=2, Criteria1:="APROVADO"
           
      ActiveCell.Offset(1, 0).Activate
      row_filtered = ActiveCell.Row
      Selection.End(xlDown).Select
      row_filtered0 = ActiveCell.Row
            
                 
      Workbooks(nomecurso & ".xlsx").Worksheets("EMAIL APROVADOS").Activate
      Range("a3:g99999").Select
      Selection.Clear
      
      Workbooks(nomecurso & ".xlsx").Worksheets("APROVADOS").Activate
      Range("a" & row_filtered0, "a" & row_filtered).Select
      Selection.Copy
       
            
      Workbooks(nomecurso & ".xlsx").Worksheets("EMAIL APROVADOS").Activate
      Range("a2").Activate
      ActiveSheet.Paste
      row_filtered_f = Selection.Rows.Count
   
   
   If row_filtered_f <> 1 Then
      Range("b" & row_filtered_f + 1, "g" & 2).Select
      Selection.FillDown
       Else
        Range("b" & row_filtered_f + 1, "g" & 2).Select
        End If
       
       
               Set wb = ThisWorkbook
               Set ws = ActiveSheet
                
            With ws
                lastRow = .Cells(.Rows.Count, "B").End(xlUp).Row
                For Each cel In .Range("B3:B" & lastRow)
                    cel.Offset(0, 0).Value = Application.Proper(cel.Value)
                Next
            End With
     
     
     
     
     
     
     
     
     'processo reprovado
      Workbooks(nomecurso & ".xlsx").Worksheets("REPROVADOS").Activate
      ActiveSheet.Range("$C$2:$D$9999").AutoFilter Field:=1
      Worksheets("REPROVADOS").PivotTables("TDREPROV").PivotCache.Refresh

    
      Range("a3").Activate
      Selection.End(xlDown).Select
      row_ult_rep = ActiveCell.Row
       
      Range("c4:C9999").Select
      Selection.Clear
            
      Range("c" & row_ult_rep, "C" & row3).Select
      Selection.FillDown
            
      'ActiveSheet.Range("$C$2:$d$9999").AutoFilter Field:=1, Criteria1:="REPROVADO"
           
      Range("a2").Activate
      ActiveCell.Offset(1, 0).Activate
      row_filtered = ActiveCell.Row
      Selection.End(xlDown).Select
      row_filtered_f = ActiveCell.Row
            
      Workbooks(nomecurso & ".xlsx").Worksheets("EMAIL REPROVADOS").Activate
      Range("a3:F99999").Select
      Selection.Clear
      
      Workbooks(nomecurso & ".xlsx").Worksheets("REPROVADOS").Activate
      Range("a" & row_filtered_f, "a" & row_filtered).Select
      Selection.Copy
            
      Workbooks(nomecurso & ".xlsx").Worksheets("EMAIL REPROVADOS").Activate
      Range("a2").Activate
      ActiveSheet.Paste
      
      If row_filtered_f = 3 Then
      Range("b" & row_filtered_f, "F" & 2).Select
      Selection.FillDown
      
      Else
      Range("b" & row_filtered_f - 1, "F" & 2).Select
      Selection.FillDown
      End If
      
      
     
     
               Set wb = ThisWorkbook
               Set ws = ActiveSheet
                  
              With ws
                  lastRow = .Cells(.Rows.Count, "B").End(xlUp).Row
                  For Each cel In .Range("B3:B" & lastRow)
                      cel.Offset(0, 0).Value = Application.Proper(cel.Value)
                  Next
              End With
               
     
     
     
   
    Application.ScreenUpdating = True
                
Unload Me

End Sub




Private Sub Label1_Click()

End Sub

Private Sub UserForm_Initialize()

getUsernameWindows = CreateObject("wscript.shell").RegRead("HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\UserName")


UserForm1.Label1.Caption = "Olá, " & getUsernameWindows & vbaNewline & ". Qual curso gostaria  de atualizar hoje?"


   ComboBox1.AddItem "Educação Financeira"
   ComboBox1.AddItem "Empreendedorismo"
   ComboBox1.AddItem "Fluxo de Caixa"
   ComboBox1.AddItem "Formas de Pagamento"
   ComboBox1.AddItem "Gestão responsável"
   ComboBox1.AddItem "Investimentos"
   ComboBox1.AddItem "Mercado Internacional"
   ComboBox1.AddItem "Negócios Internacionais"
   ComboBox1.AddItem "Tudo sobre MEI"

    
    
    Application.ScreenUpdating = False
 
 

   
   End Sub






=======================



Public Sub historico()


'fName = "C:\Users\T780000\Desktop\MARÇO\AVANÇAR\Automação fluxo de certificacoes\Bases\Histórico de acessos.xlsx"
fName = "C:\Users\T731137\Desktop\Automação fluxo de certificacoes\Bases\Histórico de acessos.xlsx"
  Workbooks.Open Filename:=fName, UpdateLinks:=True
  Range("a2").Activate
Range(Selection, Selection.End(xlToRight)).Select

Range(Selection, Selection.End(xlDown)).Select
Selection.Clear

  
  
  

fName2 = "C:\Users\T731137\Downloads\HISTORICOFINAL.xlsx"
 Workbooks.Open Filename:=fName2, UpdateLinks:=True
 
 
 
Range("a2").Activate
Range(Selection, Selection.End(xlToRight)).Select

Range(Selection, Selection.End(xlDown)).Select
Selection.Copy


 Workbooks("Histórico de acessos.xlsx").Sheets("hist").Activate
 Range("a2").Activate
 ActiveSheet.Paste




End Sub




=====================================

Public Sub curso()



Dim myUserForm2 As UserForm1
Set myUserForm2 = New UserForm1
 myUserForm2.Show
 
 


 Application.ScreenUpdating = True



End Sub
